<Window
    x:Class="CyreneGUI.Views.Main.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:cu="using:CyreneCore.Utils"
    xmlns:gu="using:CyreneGUI.Utils"
    xmlns:v="using:CyreneGUI.Components.Notify">

    <Window.SystemBackdrop>
        <MicaBackdrop Kind="BaseAlt"/>
    </Window.SystemBackdrop>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Border x:Name="BgVideoBorder"
                Grid.RowSpan="2">
            <MediaPlayerElement x:Name="BgVideo"
                                AreTransportControlsEnabled="False"
                                Stretch="UniformToFill"/>
        </Border>

        <NavigationView x:Name="NavView"
                        Grid.Row="1"
                        IsBackButtonVisible="Collapsed"
                        IsSettingsVisible="False"
                        PaneDisplayMode="LeftCompact"
                        IsPaneToggleButtonVisible="False"
                        CompactPaneLength="60"
                        SelectionChanged="NavView_SelectionChanged">
            <NavigationView.Resources>
                <x:Double x:Key="NavigationViewItemOnLeftIconBoxWidth">32</x:Double>
                <x:Double x:Key="NavigationViewItemOnLeftIconBoxHeight">32</x:Double>
                <Style TargetType="NavigationViewItem">
                    <Setter Property="Height" Value="60"/>
                    <Setter Property="Width" Value="60"/>
                </Style>
                <SolidColorBrush x:Key="NavigationViewContentBackground" Color="Transparent" />
                <Thickness x:Key="NavigationViewContentMargin">0</Thickness>
                <Thickness x:Key="NavigationViewContentGridBorderThickness">0</Thickness>
            </NavigationView.Resources>

            <NavigationView.MenuItems>
                <NavigationViewItem Content="{gu:Tr K=HomePage}" Tag="HomePage">
                    <NavigationViewItem.Icon>
                        <ImageIcon Source="{x:Bind gu:AppUtil.GetImage('Home.svg')}"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>

                <NavigationViewItem Content="{gu:Tr K=WorkPage}" Tag="WorkPage">
                    <NavigationViewItem.Icon>
                        <ImageIcon Source="{x:Bind gu:AppUtil.GetImage('AppList.svg')}"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>

                <NavigationViewItem Content="{gu:Tr K=ConsolePage}" Tag="ConsolePage">
                    <NavigationViewItem.Icon>
                        <ImageIcon Source="{x:Bind gu:AppUtil.GetImage('Code.svg')}"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>

                <NavigationViewItem Content="{gu:Tr K=SettingPage}" Tag="SettingPage">
                    <NavigationViewItem.Icon>
                        <ImageIcon Source="{x:Bind gu:AppUtil.GetImage('Wrench.svg')}"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>

                <NavigationViewItem Content="{gu:Tr K=AboutPage}" Tag="AboutPage">
                    <NavigationViewItem.Icon>
                        <ImageIcon Source="{x:Bind gu:AppUtil.GetImage('Link.svg')}"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
            </NavigationView.MenuItems>

            <NavigationView.FooterMenuItems>
                <NavigationViewItem x:Name="PuzzleNavItem"
                                    Content="{gu:Tr K=WorldPage}"
                                    Tag="WorldPage"
                                    SelectsOnInvoked="False"
                                    Tapped="{x:Bind Puzzle_Tapped}"/>
            </NavigationView.FooterMenuItems>

            <Frame x:Name="ContentFrame"
                   Margin="0"/>
        </NavigationView>

        <Border x:Name="AppTitleBar"
                Height="48"
                Padding="16,0,0,0"
                VerticalAlignment="Top">
            <StackPanel VerticalAlignment="Center"
                        Orientation="Horizontal">
                <Image Source="{x:Bind gu:AppUtil.GetImage('Cyrene.png')}"
                       Width="18"
                       Height="18"
                       VerticalAlignment="Center"/>
                <TextBlock Text="{x:Bind cu:CoreConst.Name}"
                           VerticalAlignment="Center"
                           Margin="12,0,0,0"
                           Style="{StaticResource CaptionTextBlockStyle}"/>
            </StackPanel>
        </Border>

        <Grid x:Name="LetterOverlay"
              Grid.RowSpan="2"
              Opacity="0"
              Background="Black"
              Visibility="Collapsed">
            <MediaPlayerElement x:Name="LetterTrans"
                                Stretch="UniformToFill"
                                AreTransportControlsEnabled="False"/>

            <Grid x:Name="LetterContainer"
                  Width="550"
                  Height="250"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Margin="-180,-50,0,0"
                  Visibility="Collapsed">
                <ScrollViewer x:Name="LetterScroller"
                              VerticalScrollBarVisibility="Hidden"
                              HorizontalScrollBarVisibility="Disabled">
                    <StackPanel x:Name="LetterPanel"
                                Orientation="Vertical"
                                VerticalAlignment="Top"/>
                </ScrollViewer>
            </Grid>

            <Button x:Name="LetterCloseButton"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Width="200"
                    Height="40"
                    Opacity="0"
                    Margin="-200,300,0,0"
                    Click="{x:Bind LetterClose_Click}"/>

            <Grid x:Name="BlackCurtain"
                  Opacity="1"
                  Background="Black"
                  IsHitTestVisible="False"/>
        </Grid>

        <Grid x:Name="SplashOverlay"
              Grid.RowSpan="2"
              Background="Black"
              Visibility="Visible"
              RenderTransformOrigin="0.5,0.5">
            <Grid.RenderTransform>
                <ScaleTransform x:Name="SplashScaleTransform"
                                ScaleX="1"
                                ScaleY="1"/>
            </Grid.RenderTransform>

            <MediaPlayerElement x:Name="Transition"
                                Stretch="Uniform"
                                AreTransportControlsEnabled="False"/>

            <Grid x:Name="MediaLayer"
                  Tapped="{x:Bind SplashOverlay_Tapped}">
                <MediaPlayerElement x:Name="Loop"
                                    Stretch="Uniform"
                                    AreTransportControlsEnabled="False"/>
            </Grid>
        </Grid>

        <TeachingTip x:Name="VerifyTip"
                        PreferredPlacement="Center"
                        Background="{StaticResource PinkToBlueBrush}">
            <TeachingTip.Content>
                <Grid Width="240" RowSpacing="12">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0"
                                FontWeight="Bold"
                                Text="{gu:Tr K=EncryptTip}"
                                HorizontalAlignment="Center"/>

                    <PasswordBox Grid.Row="1"
                                    x:Name="PwdBox"
                                    PasswordRevealMode="Visible"
                                    PlaceholderText="{gu:Tr K=EncryptPwd}"/>

                    <Grid Grid.Row="2" ColumnSpacing="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Button Grid.Column="0"
                                Content="{gu:Tr K=Confirm}"
                                Click="{x:Bind Confirm_Click}"
                                HorizontalAlignment="Stretch"
                                Style="{ThemeResource AccentButtonStyle}"/>

                        <Button Grid.Column="1"
                                Content="{gu:Tr K=Cancel}"
                                Click="{x:Bind Cancel_Click}"
                                HorizontalAlignment="Stretch"/>
                    </Grid>
                </Grid>
            </TeachingTip.Content>
        </TeachingTip>

        <v:NotifyPanel Grid.RowSpan="2"/>
    </Grid>
</Window>